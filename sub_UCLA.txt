nohup: ignoring input
/home/peng.1007/miniconda3/envs/BPMT_env/lib/python3.10/site-packages/torch/nn/modules/transformer.py:385: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(
pretrain?: True
hidden_size: 256
n_heads: 8
num_layers: 4
batch_size: 4
==================================================
[INFO] Starting NW-UCLA dataset processing on cuda...
==================================================
[INFO] Using subtraction-based bone data type...
Collected 10200 sequences for train + val.
Each sequence shape: torch.Size([64, 60])
Collected 464 sequences for test.
Each sequence shape: torch.Size([64, 60])
[INFO] Number of classes: 10
====================================================================================================

==========================
Starting Pretraining...
==========================
[INFO] Mask ratio: 30.0%
[INFO] train/val split ratio: 5.0%
  0%|          | 0/1000 [00:00<?, ?it/s]/home/peng.1007/BPMT/baseline/action_recognition/subtraction_bone/n_ucla/base_dataset.py:15: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  seq   = torch.tensor(self.seqs[idx],   dtype=torch.float32)
                                          0%|          | 0/1000 [00:20<?, ?it/s]  0%|          | 1/1000 [00:20<5:36:57, 20.24s/it]                                                    0%|          | 1/1000 [00:35<5:36:57, 20.24s/it]  0%|          | 2/1000 [00:35<4:50:06, 17.44s/it]                                                    0%|          | 2/1000 [00:51<4:50:06, 17.44s/it]  0%|          | 3/1000 [00:51<4:37:50, 16.72s/it]                                                    0%|          | 3/1000 [01:08<4:37:50, 16.72s/it]  0%|          | 4/1000 [01:08<4:36:03, 16.63s/it]                                                    0%|          | 4/1000 [01:23<4:36:03, 16.63s/it]  0%|          | 5/1000 [01:23<4:30:11, 16.29s/it]                                                    0%|          | 5/1000 [01:40<4:30:11, 16.29s/it]  1%|          | 6/1000 [01:40<4:30:44, 16.34s/it]                                                    1%|          | 6/1000 [01:55<4:30:44, 16.34s/it]  1%|          | 7/1000 [01:55<4:25:53, 16.07s/it]                                                    1%|          | 7/1000 [02:11<4:25:53, 16.07s/it]  1%|          | 8/1000 [02:11<4:22:59, 15.91s/it]                                                    1%|          | 8/1000 [02:26<4:22:59, 15.91s/it]  1%|          | 9/1000 [02:26<4:21:03, 15.81s/it]                                                    1%|          | 9/1000 [02:44<4:21:03, 15.81s/it]  1%|          | 10/1000 [02:44<4:31:40, 16.46s/it]                                                     1%|          | 10/1000 [03:00<4:31:40, 16.46s/it]  1%|          | 11/1000 [03:00<4:27:43, 16.24s/it]                                                     1%|          | 11/1000 [03:16<4:27:43, 16.24s/it]  1%|          | 12/1000 [03:16<4:27:21, 16.24s/it]                                                     1%|          | 12/1000 [03:33<4:27:21, 16.24s/it]  1%|▏         | 13/1000 [03:33<4:27:24, 16.26s/it]                                                     1%|▏         | 13/1000 [03:48<4:27:24, 16.26s/it]  1%|▏         | 14/1000 [03:48<4:24:20, 16.09s/it]                                                     1%|▏         | 14/1000 [04:04<4:24:20, 16.09s/it]  2%|▏         | 15/1000 [04:04<4:21:27, 15.93s/it]                                                     2%|▏         | 15/1000 [04:20<4:21:27, 15.93s/it]  2%|▏         | 16/1000 [04:20<4:22:30, 16.01s/it]                                                     2%|▏         | 16/1000 [04:38<4:22:30, 16.01s/it]  2%|▏         | 17/1000 [04:38<4:30:36, 16.52s/it]                                                     2%|▏         | 17/1000 [04:55<4:30:36, 16.52s/it]  2%|▏         | 18/1000 [04:55<4:36:11, 16.88s/it]                                                     2%|▏         | 18/1000 [05:13<4:36:11, 16.88s/it]  2%|▏         | 19/1000 [05:13<4:40:07, 17.13s/it]                                                     2%|▏         | 19/1000 [05:30<4:40:07, 17.13s/it]  2%|▏         | 20/1000 [05:30<4:36:34, 16.93s/it]                                                     2%|▏         | 20/1000 [05:47<4:36:34, 16.93s/it]  2%|▏         | 21/1000 [05:47<4:37:09, 16.99s/it]                                                     2%|▏         | 21/1000 [06:02<4:37:09, 16.99s/it]  2%|▏         | 22/1000 [06:02<4:30:07, 16.57s/it]                                                     2%|▏         | 22/1000 [06:20<4:30:07, 16.57s/it]  2%|▏         | 23/1000 [06:20<4:34:50, 16.88s/it]                                                     2%|▏         | 23/1000 [06:36<4:34:50, 16.88s/it]  2%|▏         | 24/1000 [06:36<4:29:19, 16.56s/it]                                                     2%|▏         | 24/1000 [06:53<4:29:19, 16.56s/it]  2%|▎         | 25/1000 [06:53<4:34:34, 16.90s/it]                                                     2%|▎         | 25/1000 [07:10<4:34:34, 16.90s/it]  3%|▎         | 26/1000 [07:10<4:31:16, 16.71s/it]                                                     3%|▎         | 26/1000 [07:27<4:31:16, 16.71s/it]  3%|▎         | 27/1000 [07:27<4:35:56, 17.02s/it]                                                     3%|▎         | 27/1000 [07:45<4:35:56, 17.02s/it]  3%|▎         | 28/1000 [07:45<4:36:48, 17.09s/it]                                                     3%|▎         | 28/1000 [08:02<4:36:48, 17.09s/it]  3%|▎         | 29/1000 [08:02<4:39:34, 17.28s/it]                                                     3%|▎         | 29/1000 [08:18<4:39:34, 17.28s/it]  3%|▎         | 30/1000 [08:18<4:30:21, 16.72s/it]                                                     3%|▎         | 30/1000 [08:34<4:30:21, 16.72s/it]  3%|▎         | 31/1000 [08:34<4:26:58, 16.53s/it]                                                     3%|▎         | 31/1000 [08:49<4:26:58, 16.53s/it]  3%|▎         | 32/1000 [08:49<4:21:11, 16.19s/it]                                                     3%|▎         | 32/1000 [09:05<4:21:11, 16.19s/it]  3%|▎         | 33/1000 [09:05<4:17:03, 15.95s/it]                                                     3%|▎         | 33/1000 [09:20<4:17:03, 15.95s/it]  3%|▎         | 34/1000 [09:20<4:14:13, 15.79s/it]                                                     3%|▎         | 34/1000 [09:36<4:14:13, 15.79s/it]  4%|▎         | 35/1000 [09:36<4:12:11, 15.68s/it]                                                     4%|▎         | 35/1000 [09:51<4:12:11, 15.68s/it]  4%|▎         | 36/1000 [09:51<4:10:48, 15.61s/it]                                                     4%|▎         | 36/1000 [10:06<4:10:48, 15.61s/it]  4%|▎         | 37/1000 [10:06<4:09:27, 15.54s/it]                                                     4%|▎         | 37/1000 [10:23<4:09:27, 15.54s/it]  4%|▍         | 38/1000 [10:23<4:13:46, 15.83s/it]                                                     4%|▍         | 38/1000 [10:39<4:13:46, 15.83s/it]  4%|▍         | 39/1000 [10:39<4:13:45, 15.84s/it]                                                     4%|▍         | 39/1000 [10:54<4:13:45, 15.84s/it]  4%|▍         | 40/1000 [10:54<4:12:10, 15.76s/it]                                                     4%|▍         | 40/1000 [11:10<4:12:10, 15.76s/it]  4%|▍         | 41/1000 [11:10<4:11:47, 15.75s/it]                                                     4%|▍         | 41/1000 [11:26<4:11:47, 15.75s/it]  4%|▍         | 42/1000 [11:26<4:10:24, 15.68s/it]                                                     4%|▍         | 42/1000 [11:41<4:10:24, 15.68s/it]  4%|▍         | 43/1000 [11:41<4:09:43, 15.66s/it]                                                     4%|▍         | 43/1000 [11:57<4:09:43, 15.66s/it]  4%|▍         | 44/1000 [11:57<4:08:49, 15.62s/it]                                                     4%|▍         | 44/1000 [12:12<4:08:49, 15.62s/it]  4%|▍         | 45/1000 [12:12<4:08:06, 15.59s/it]                                                     4%|▍         | 45/1000 [12:29<4:08:06, 15.59s/it]  5%|▍         | 46/1000 [12:29<4:14:39, 16.02s/it]                                                     5%|▍         | 46/1000 [12:45<4:14:39, 16.02s/it]  5%|▍         | 47/1000 [12:45<4:11:48, 15.85s/it]                                                     5%|▍         | 47/1000 [13:00<4:11:48, 15.85s/it]  5%|▍         | 48/1000 [13:00<4:09:24, 15.72s/it]                                                     5%|▍         | 48/1000 [13:15<4:09:24, 15.72s/it]  5%|▍         | 49/1000 [13:15<4:07:36, 15.62s/it]                                                     5%|▍         | 49/1000 [13:31<4:07:36, 15.62s/it]  5%|▌         | 50/1000 [13:31<4:06:20, 15.56s/it]                                                     5%|▌         | 50/1000 [13:48<4:06:20, 15.56s/it]  5%|▌         | 51/1000 [13:48<4:11:31, 15.90s/it]                                                     5%|▌         | 51/1000 [14:05<4:11:31, 15.90s/it]  5%|▌         | 52/1000 [14:05<4:19:49, 16.44s/it]                                                     5%|▌         | 52/1000 [14:22<4:19:49, 16.44s/it]  5%|▌         | 53/1000 [14:22<4:18:27, 16.38s/it]                                                     5%|▌         | 53/1000 [14:37<4:18:27, 16.38s/it]  5%|▌         | 54/1000 [14:37<4:14:22, 16.13s/it]                                                     5%|▌         | 54/1000 [14:53<4:14:22, 16.13s/it]  6%|▌         | 55/1000 [14:53<4:10:55, 15.93s/it]                                                     6%|▌         | 55/1000 [15:08<4:10:55, 15.93s/it]  6%|▌         | 56/1000 [15:08<4:08:53, 15.82s/it]                                                     6%|▌         | 56/1000 [15:24<4:08:53, 15.82s/it]  6%|▌         | 57/1000 [15:24<4:07:22, 15.74s/it]                                                     6%|▌         | 57/1000 [15:41<4:07:22, 15.74s/it]  6%|▌         | 58/1000 [15:41<4:12:12, 16.06s/it]                                                     6%|▌         | 58/1000 [15:56<4:12:12, 16.06s/it]  6%|▌         | 59/1000 [15:56<4:09:30, 15.91s/it]                                                     6%|▌         | 59/1000 [16:12<4:09:30, 15.91s/it]  6%|▌         | 60/1000 [16:12<4:07:58, 15.83s/it]                                                     6%|▌         | 60/1000 [16:27<4:07:58, 15.83s/it]  6%|▌         | 61/1000 [16:27<4:06:26, 15.75s/it]                                                     6%|▌         | 61/1000 [16:43<4:06:26, 15.75s/it]  6%|▌         | 62/1000 [16:43<4:06:11, 15.75s/it]                                                     6%|▌         | 62/1000 [17:01<4:06:11, 15.75s/it]  6%|▋         | 63/1000 [17:01<4:15:06, 16.34s/it]                                                     6%|▋         | 63/1000 [17:16<4:15:06, 16.34s/it]  6%|▋         | 64/1000 [17:16<4:11:16, 16.11s/it]                                                     6%|▋         | 64/1000 [17:33<4:11:16, 16.11s/it]  6%|▋         | 65/1000 [17:33<4:14:25, 16.33s/it]                                                     6%|▋         | 65/1000 [17:49<4:14:25, 16.33s/it]  7%|▋         | 66/1000 [17:49<4:12:41, 16.23s/it]                                                     7%|▋         | 66/1000 [18:06<4:12:41, 16.23s/it]  7%|▋         | 67/1000 [18:06<4:13:45, 16.32s/it]                                                     7%|▋         | 67/1000 [18:21<4:13:45, 16.32s/it]  7%|▋         | 68/1000 [18:21<4:10:40, 16.14s/it]                                                     7%|▋         | 68/1000 [18:37<4:10:40, 16.14s/it]  7%|▋         | 69/1000 [18:37<4:07:59, 15.98s/it]                                                     7%|▋         | 69/1000 [18:53<4:07:59, 15.98s/it]  7%|▋         | 70/1000 [18:53<4:05:44, 15.85s/it]                                                     7%|▋         | 70/1000 [19:09<4:05:44, 15.85s/it]  7%|▋         | 71/1000 [19:09<4:09:26, 16.11s/it]                                                     7%|▋         | 71/1000 [19:25<4:09:26, 16.11s/it]  7%|▋         | 72/1000 [19:25<4:07:19, 15.99s/it]                                                     7%|▋         | 72/1000 [19:41<4:07:19, 15.99s/it]  7%|▋         | 73/1000 [19:41<4:05:01, 15.86s/it]                                                     7%|▋         | 73/1000 [19:57<4:05:01, 15.86s/it]  7%|▋         | 74/1000 [19:57<4:06:52, 16.00s/it]                                                     7%|▋         | 74/1000 [20:12<4:06:52, 16.00s/it]  8%|▊         | 75/1000 [20:12<4:04:36, 15.87s/it]                                                     8%|▊         | 75/1000 [20:30<4:04:36, 15.87s/it]  8%|▊         | 76/1000 [20:30<4:12:44, 16.41s/it]                                                     8%|▊         | 76/1000 [20:46<4:12:44, 16.41s/it]  8%|▊         | 77/1000 [20:46<4:11:05, 16.32s/it]                                                     8%|▊         | 77/1000 [21:04<4:11:05, 16.32s/it]  8%|▊         | 78/1000 [21:04<4:16:41, 16.70s/it]                                                     8%|▊         | 78/1000 [21:20<4:16:41, 16.70s/it]  8%|▊         | 79/1000 [21:20<4:15:55, 16.67s/it]                                                     8%|▊         | 79/1000 [21:38<4:15:55, 16.67s/it]  8%|▊         | 80/1000 [21:38<4:20:26, 16.99s/it]                                                     8%|▊         | 80/1000 [21:54<4:20:26, 16.99s/it]  8%|▊         | 81/1000 [21:54<4:14:39, 16.63s/it]                                                     8%|▊         | 81/1000 [22:12<4:14:39, 16.63s/it]  8%|▊         | 82/1000 [22:12<4:19:15, 16.94s/it]                                                     8%|▊         | 82/1000 [22:29<4:19:15, 16.94s/it]  8%|▊         | 83/1000 [22:29<4:22:29, 17.17s/it]                                                     8%|▊         | 83/1000 [22:47<4:22:29, 17.17s/it]  8%|▊         | 84/1000 [22:47<4:24:12, 17.31s/it]                                                     8%|▊         | 84/1000 [23:04<4:24:12, 17.31s/it]  8%|▊         | 85/1000 [23:04<4:22:32, 17.22s/it]                                                     8%|▊         | 85/1000 [23:20<4:22:32, 17.22s/it]  9%|▊         | 86/1000 [23:20<4:18:20, 16.96s/it]                                                     9%|▊         | 86/1000 [23:36<4:18:20, 16.96s/it]  9%|▊         | 87/1000 [23:36<4:12:07, 16.57s/it]                                                     9%|▊         | 87/1000 [23:54<4:12:07, 16.57s/it]  9%|▉         | 88/1000 [23:54<4:18:10, 16.99s/it]                                                     9%|▉         | 88/1000 [24:09<4:18:10, 16.99s/it]  9%|▉         | 89/1000 [24:09<4:11:15, 16.55s/it]                                                     9%|▉         | 89/1000 [24:26<4:11:15, 16.55s/it]  9%|▉         | 90/1000 [24:26<4:12:57, 16.68s/it]                                                     9%|▉         | 90/1000 [24:43<4:12:57, 16.68s/it]  9%|▉         | 91/1000 [24:43<4:14:17, 16.78s/it]                                                     9%|▉         | 91/1000 [25:00<4:14:17, 16.78s/it]  9%|▉         | 92/1000 [25:00<4:12:15, 16.67s/it]                                                     9%|▉         | 92/1000 [25:19<4:12:15, 16.67s/it]  9%|▉         | 93/1000 [25:19<4:25:25, 17.56s/it]                                                     9%|▉         | 93/1000 [25:37<4:25:25, 17.56s/it]  9%|▉         | 94/1000 [25:37<4:24:10, 17.50s/it]                                                     9%|▉         | 94/1000 [25:54<4:24:10, 17.50s/it] 10%|▉         | 95/1000 [25:54<4:22:38, 17.41s/it]                                                    10%|▉         | 95/1000 [26:11<4:22:38, 17.41s/it] 10%|▉         | 96/1000 [26:11<4:21:46, 17.37s/it]                                                    10%|▉         | 96/1000 [26:29<4:21:46, 17.37s/it] 10%|▉         | 97/1000 [26:29<4:21:09, 17.35s/it]                                                    10%|▉         | 97/1000 [26:44<4:21:09, 17.35s/it] 10%|▉         | 98/1000 [26:44<4:13:21, 16.85s/it]                                                    10%|▉         | 98/1000 [27:00<4:13:21, 16.85s/it] 10%|▉         | 99/1000 [27:00<4:07:45, 16.50s/it]                                                    10%|▉         | 99/1000 [27:16<4:07:45, 16.50s/it] 10%|█         | 100/1000 [27:16<4:03:26, 16.23s/it]                                                     10%|█         | 100/1000 [27:31<4:03:26, 16.23s/it] 10%|█         | 101/1000 [27:31<4:00:39, 16.06s/it]                                                     10%|█         | 101/1000 [27:47<4:00:39, 16.06s/it] 10%|█         | 102/1000 [27:47<3:58:20, 15.92s/it]                                                     10%|█         | 102/1000 [28:03<3:58:20, 15.92s/it] 10%|█         | 103/1000 [28:03<3:58:29, 15.95s/it]                                                     10%|█         | 103/1000 [28:19<3:58:29, 15.95s/it] 10%|█         | 104/1000 [28:19<3:58:10, 15.95s/it]                                                     10%|█         | 104/1000 [28:35<3:58:10, 15.95s/it] 10%|█         | 105/1000 [28:35<3:57:32, 15.92s/it]