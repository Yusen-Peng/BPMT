nohup: ignoring input
pretrain?: True
hidden_size: 256
n_heads: 8
num_layers: 4
batch_size: 4
==================================================
[INFO] Starting NW-UCLA dataset processing on cuda...
==================================================
[INFO]: proability of dropping regularization: 0.1
[INFO]: data being repeated by 15 times
✈️✈️✈️✈️✈️✈️✈️✈️✈️✈️✈️✈️✈️✈️✈️✈️✈️✈️✈️✈️
training mode: train
Collected 15300 sequences for train + val.
Each sequence shape: torch.Size([3, 64, 20, 1])
✈️✈️✈️✈️✈️✈️✈️✈️✈️✈️✈️✈️✈️✈️✈️✈️✈️✈️✈️✈️
training mode: val

==========================
Starting Pretraining...
==========================
[INFO] Mask ratio: 30.0%
[INFO] train/val split ratio: 5.0%
  0%|          | 0/100 [00:00<?, ?it/s]/home/peng.1007/BPMT/baseline/action_recognition/cascadeformer_1_2/joint/n_ucla/base_dataset.py:15: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  seq   = torch.tensor(self.seqs[idx],   dtype=torch.float32)
                                         0%|          | 0/100 [01:39<?, ?it/s]  1%|          | 1/100 [01:39<2:44:04, 99.43s/it]                                                   1%|          | 1/100 [03:18<2:44:04, 99.43s/it]  2%|▏         | 2/100 [03:18<2:42:02, 99.21s/it]                                                   2%|▏         | 2/100 [04:57<2:42:02, 99.21s/it]  3%|▎         | 3/100 [04:57<2:40:20, 99.18s/it]                                                   3%|▎         | 3/100 [06:38<2:40:20, 99.18s/it]  4%|▍         | 4/100 [06:38<2:39:39, 99.78s/it]                                                   4%|▍         | 4/100 [08:17<2:39:39, 99.78s/it]  5%|▌         | 5/100 [08:17<2:37:38, 99.57s/it]                                                   5%|▌         | 5/100 [09:57<2:37:38, 99.57s/it]  6%|▌         | 6/100 [09:57<2:35:58, 99.56s/it]                                                   6%|▌         | 6/100 [11:36<2:35:58, 99.56s/it]  7%|▋         | 7/100 [11:36<2:34:16, 99.53s/it]                                                   7%|▋         | 7/100 [13:17<2:34:16, 99.53s/it]  8%|▊         | 8/100 [13:17<2:33:14, 99.94s/it]                                                   8%|▊         | 8/100 [14:56<2:33:14, 99.94s/it]  9%|▉         | 9/100 [14:56<2:31:16, 99.74s/it]                                                   9%|▉         | 9/100 [16:35<2:31:16, 99.74s/it] 10%|█         | 10/100 [16:35<2:29:24, 99.60s/it]                                                   10%|█         | 10/100 [18:15<2:29:24, 99.60s/it] 11%|█         | 11/100 [18:15<2:27:36, 99.51s/it]                                                   11%|█         | 11/100 [19:54<2:27:36, 99.51s/it] 12%|█▏        | 12/100 [19:54<2:25:44, 99.37s/it]                                                   12%|█▏        | 12/100 [21:35<2:25:44, 99.37s/it] 13%|█▎        | 13/100 [21:35<2:24:45, 99.83s/it]                                                   13%|█▎        | 13/100 [23:14<2:24:45, 99.83s/it] 14%|█▍        | 14/100 [23:14<2:22:52, 99.68s/it]                                                   14%|█▍        | 14/100 [24:53<2:22:52, 99.68s/it] 15%|█▌        | 15/100 [24:53<2:21:06, 99.60s/it]                                                   15%|█▌        | 15/100 [26:33<2:21:06, 99.60s/it] 16%|█▌        | 16/100 [26:33<2:19:18, 99.50s/it]                                                   16%|█▌        | 16/100 [28:14<2:19:18, 99.50s/it] 17%|█▋        | 17/100 [28:14<2:18:13, 99.92s/it]                                                   17%|█▋        | 17/100 [29:52<2:18:13, 99.92s/it] 18%|█▊        | 18/100 [29:52<2:15:58, 99.49s/it]                                                   18%|█▊        | 18/100 [31:31<2:15:58, 99.49s/it] 19%|█▉        | 19/100 [31:31<2:14:15, 99.45s/it]                                                   19%|█▉        | 19/100 [33:11<2:14:15, 99.45s/it] 20%|██        | 20/100 [33:11<2:12:35, 99.44s/it]                                                   20%|██        | 20/100 [34:50<2:12:35, 99.44s/it] 21%|██        | 21/100 [34:50<2:10:55, 99.43s/it]                                                   21%|██        | 21/100 [36:31<2:10:55, 99.43s/it] 22%|██▏       | 22/100 [36:31<2:09:51, 99.89s/it]                                                   22%|██▏       | 22/100 [38:11<2:09:51, 99.89s/it] 23%|██▎       | 23/100 [38:11<2:08:02, 99.78s/it]                                                   23%|██▎       | 23/100 [39:51<2:08:02, 99.78s/it] 24%|██▍       | 24/100 [39:51<2:06:25, 99.81s/it]                                                   24%|██▍       | 24/100 [41:30<2:06:25, 99.81s/it] 25%|██▌       | 25/100 [41:30<2:04:41, 99.75s/it]                                                   25%|██▌       | 25/100 [43:11<2:04:41, 99.75s/it] 26%|██▌       | 26/100 [43:11<2:03:27, 100.11s/it]                                                    26%|██▌       | 26/100 [44:50<2:03:27, 100.11s/it] 27%|██▋       | 27/100 [44:50<2:01:28, 99.85s/it]                                                    27%|██▋       | 27/100 [46:30<2:01:28, 99.85s/it] 28%|██▊       | 28/100 [46:30<1:59:34, 99.64s/it]                                                   28%|██▊       | 28/100 [48:09<1:59:34, 99.64s/it] 29%|██▉       | 29/100 [48:09<1:57:39, 99.43s/it]                                                   29%|██▉       | 29/100 [49:47<1:57:39, 99.43s/it] 30%|███       | 30/100 [49:47<1:55:47, 99.25s/it]                                                   30%|███       | 30/100 [51:28<1:55:47, 99.25s/it] 31%|███       | 31/100 [51:28<1:54:32, 99.60s/it]                                                   31%|███       | 31/100 [53:07<1:54:32, 99.60s/it] 32%|███▏      | 32/100 [53:07<1:52:41, 99.43s/it]                                                   32%|███▏      | 32/100 [54:46<1:52:41, 99.43s/it] 33%|███▎      | 33/100 [54:46<1:50:50, 99.26s/it]                                                   33%|███▎      | 33/100 [56:25<1:50:50, 99.26s/it] 34%|███▍      | 34/100 [56:25<1:49:04, 99.15s/it]                                                   34%|███▍      | 34/100 [58:05<1:49:04, 99.15s/it] 35%|███▌      | 35/100 [58:05<1:47:50, 99.54s/it]                                                   35%|███▌      | 35/100 [59:44<1:47:50, 99.54s/it] 36%|███▌      | 36/100 [59:44<1:46:00, 99.38s/it]                                                   36%|███▌      | 36/100 [1:01:23<1:46:00, 99.38s/it] 37%|███▋      | 37/100 [1:01:23<1:44:12, 99.25s/it]                                                     37%|███▋      | 37/100 [1:03:02<1:44:12, 99.25s/it] 38%|███▊      | 38/100 [1:03:02<1:42:30, 99.20s/it]                                                     38%|███▊      | 38/100 [1:04:41<1:42:30, 99.20s/it] 39%|███▉      | 39/100 [1:04:41<1:40:49, 99.17s/it]                                                     39%|███▉      | 39/100 [1:06:22<1:40:49, 99.17s/it] 40%|████      | 40/100 [1:06:22<1:39:35, 99.60s/it]                                                     40%|████      | 40/100 [1:08:01<1:39:35, 99.60s/it] 41%|████      | 41/100 [1:08:01<1:37:49, 99.49s/it]                                                     41%|████      | 41/100 [1:09:40<1:37:49, 99.49s/it] 42%|████▏     | 42/100 [1:09:40<1:36:04, 99.39s/it]                                                     42%|████▏     | 42/100 [1:11:19<1:36:04, 99.39s/it] 43%|████▎     | 43/100 [1:11:19<1:34:21, 99.32s/it]                                                     43%|████▎     | 43/100 [1:13:01<1:34:21, 99.32s/it] 44%|████▍     | 44/100 [1:13:01<1:33:22, 100.04s/it]                                                      44%|████▍     | 44/100 [1:14:40<1:33:22, 100.04s/it] 45%|████▌     | 45/100 [1:14:40<1:31:28, 99.79s/it]                                                      45%|████▌     | 45/100 [1:16:20<1:31:28, 99.79s/it] 46%|████▌     | 46/100 [1:16:20<1:29:42, 99.67s/it]                                                     46%|████▌     | 46/100 [1:17:59<1:29:42, 99.67s/it] 47%|████▋     | 47/100 [1:17:59<1:27:56, 99.55s/it]                                                     47%|████▋     | 47/100 [1:19:38<1:27:56, 99.55s/it] 48%|████▊     | 48/100 [1:19:38<1:26:11, 99.46s/it]                                                     48%|████▊     | 48/100 [1:21:19<1:26:11, 99.46s/it] 49%|████▉     | 49/100 [1:21:19<1:24:57, 99.95s/it]                                                     49%|████▉     | 49/100 [1:22:58<1:24:57, 99.95s/it] 50%|█████     | 50/100 [1:22:58<1:23:06, 99.74s/it]                                                     50%|█████     | 50/100 [1:24:38<1:23:06, 99.74s/it] 51%|█████     | 51/100 [1:24:38<1:21:18, 99.57s/it]                                                     51%|█████     | 51/100 [1:26:17<1:21:18, 99.57s/it] 52%|█████▏    | 52/100 [1:26:17<1:19:33, 99.46s/it]                                                     52%|█████▏    | 52/100 [1:27:58<1:19:33, 99.46s/it] 53%|█████▎    | 53/100 [1:27:58<1:18:13, 99.86s/it]                                                     53%|█████▎    | 53/100 [1:29:37<1:18:13, 99.86s/it] 54%|█████▍    | 54/100 [1:29:37<1:16:25, 99.68s/it]                                                     54%|█████▍    | 54/100 [1:31:16<1:16:25, 99.68s/it] 55%|█████▌    | 55/100 [1:31:16<1:14:38, 99.53s/it]                                                     55%|█████▌    | 55/100 [1:32:55<1:14:38, 99.53s/it] 56%|█████▌    | 56/100 [1:32:55<1:12:54, 99.42s/it]                                                     56%|█████▌    | 56/100 [1:34:34<1:12:54, 99.42s/it] 57%|█████▋    | 57/100 [1:34:34<1:11:03, 99.15s/it]                                                     57%|█████▋    | 57/100 [1:36:15<1:11:03, 99.15s/it] 58%|█████▊    | 58/100 [1:36:15<1:09:56, 99.92s/it]                                                     58%|█████▊    | 58/100 [1:37:55<1:09:56, 99.92s/it] 59%|█████▉    | 59/100 [1:37:55<1:08:08, 99.72s/it]                                                     59%|█████▉    | 59/100 [1:39:35<1:08:08, 99.72s/it] 60%|██████    | 60/100 [1:39:35<1:06:30, 99.75s/it]                                                     60%|██████    | 60/100 [1:41:15<1:06:30, 99.75s/it] 61%|██████    | 61/100 [1:41:15<1:04:53, 99.82s/it]                                                     61%|██████    | 61/100 [1:42:55<1:04:53, 99.82s/it] 62%|██████▏   | 62/100 [1:42:55<1:03:24, 100.13s/it]                                                      62%|██████▏   | 62/100 [1:44:35<1:03:24, 100.13s/it] 63%|██████▎   | 63/100 [1:44:35<1:01:34, 99.85s/it]                                                      63%|██████▎   | 63/100 [1:46:14<1:01:34, 99.85s/it] 64%|██████▍   | 64/100 [1:46:14<59:47, 99.64s/it]                                                     64%|██████▍   | 64/100 [1:47:53<59:47, 99.64s/it] 65%|██████▌   | 65/100 [1:47:53<58:03, 99.54s/it]                                                   65%|██████▌   | 65/100 [1:49:32<58:03, 99.54s/it] 66%|██████▌   | 66/100 [1:49:32<56:20, 99.42s/it]                                                   66%|██████▌   | 66/100 [1:51:13<56:20, 99.42s/it] 67%|██████▋   | 67/100 [1:51:13<54:51, 99.74s/it]                                                   67%|██████▋   | 67/100 [1:52:52<54:51, 99.74s/it] 68%|██████▊   | 68/100 [1:52:52<53:03, 99.48s/it]                                                   68%|██████▊   | 68/100 [1:54:30<53:03, 99.48s/it] 69%|██████▉   | 69/100 [1:54:30<51:18, 99.29s/it]                                                   69%|██████▉   | 69/100 [1:56:09<51:18, 99.29s/it] 70%|███████   | 70/100 [1:56:09<49:34, 99.15s/it]                                                   70%|███████   | 70/100 [1:57:50<49:34, 99.15s/it] 71%|███████   | 71/100 [1:57:50<48:06, 99.52s/it]                                                   71%|███████   | 71/100 [1:59:28<48:06, 99.52s/it] 72%|███████▏  | 72/100 [1:59:28<46:19, 99.27s/it]                                                   72%|███████▏  | 72/100 [2:01:07<46:19, 99.27s/it] 73%|███████▎  | 73/100 [2:01:07<44:37, 99.15s/it]                                                   73%|███████▎  | 73/100 [2:02:46<44:37, 99.15s/it] 74%|███████▍  | 74/100 [2:02:46<42:55, 99.06s/it]                                                   74%|███████▍  | 74/100 [2:04:24<42:55, 99.06s/it] 75%|███████▌  | 75/100 [2:04:24<41:11, 98.88s/it]                                                   75%|███████▌  | 75/100 [2:06:05<41:11, 98.88s/it] 76%|███████▌  | 76/100 [2:06:05<39:44, 99.37s/it]                                                   76%|███████▌  | 76/100 [2:07:44<39:44, 99.37s/it] 77%|███████▋  | 77/100 [2:07:44<38:02, 99.22s/it]                                                   77%|███████▋  | 77/100 [2:09:23<38:02, 99.22s/it] 78%|███████▊  | 78/100 [2:09:23<36:21, 99.16s/it]                                                   78%|███████▊  | 78/100 [2:11:02<36:21, 99.16s/it] 79%|███████▉  | 79/100 [2:11:02<34:43, 99.19s/it]                                                   79%|███████▉  | 79/100 [2:12:43<34:43, 99.19s/it] 80%|████████  | 80/100 [2:12:43<33:12, 99.62s/it]                                                   80%|████████  | 80/100 [2:14:22<33:12, 99.62s/it] 81%|████████  | 81/100 [2:14:22<31:29, 99.44s/it]                                                   81%|████████  | 81/100 [2:16:01<31:29, 99.44s/it] 82%|████████▏ | 82/100 [2:16:01<29:47, 99.31s/it]                                                   82%|████████▏ | 82/100 [2:17:40<29:47, 99.31s/it] 83%|████████▎ | 83/100 [2:17:40<28:06, 99.22s/it]                                                   83%|████████▎ | 83/100 [2:19:19<28:06, 99.22s/it] 84%|████████▍ | 84/100 [2:19:19<26:26, 99.18s/it]                                                   84%|████████▍ | 84/100 [2:20:59<26:26, 99.18s/it] 85%|████████▌ | 85/100 [2:20:59<24:50, 99.38s/it]                                                   85%|████████▌ | 85/100 [2:22:38<24:50, 99.38s/it] 86%|████████▌ | 86/100 [2:22:38<23:10, 99.30s/it]                                                   86%|████████▌ | 86/100 [2:24:17<23:10, 99.30s/it] 87%|████████▋ | 87/100 [2:24:17<21:30, 99.27s/it]                                                   87%|████████▋ | 87/100 [2:25:56<21:30, 99.27s/it] 88%|████████▊ | 88/100 [2:25:56<19:50, 99.25s/it]                                                   88%|████████▊ | 88/100 [2:27:37<19:50, 99.25s/it] 89%|████████▉ | 89/100 [2:27:37<18:17, 99.74s/it]                                                   89%|████████▉ | 89/100 [2:29:16<18:17, 99.74s/it] 90%|█████████ | 90/100 [2:29:16<16:35, 99.55s/it]                                                   90%|█████████ | 90/100 [2:30:56<16:35, 99.55s/it] 91%|█████████ | 91/100 [2:30:56<14:56, 99.56s/it]                                                   91%|█████████ | 91/100 [2:32:36<14:56, 99.56s/it] 92%|█████████▏| 92/100 [2:32:36<13:17, 99.65s/it]                                                   92%|█████████▏| 92/100 [2:34:16<13:17, 99.65s/it] 93%|█████████▎| 93/100 [2:34:16<11:39, 99.87s/it]                                                   93%|█████████▎| 93/100 [2:35:56<11:39, 99.87s/it] 94%|█████████▍| 94/100 [2:35:56<09:58, 99.77s/it]                                                   94%|█████████▍| 94/100 [2:37:35<09:58, 99.77s/it] 95%|█████████▌| 95/100 [2:37:35<08:18, 99.71s/it]                                                   95%|█████████▌| 95/100 [2:38:54<08:18, 99.71s/it] 96%|█████████▌| 96/100 [2:38:54<06:13, 93.37s/it]                                                   96%|█████████▌| 96/100 [2:39:31<06:13, 93.37s/it] 97%|█████████▋| 97/100 [2:39:31<03:49, 76.45s/it]                                                   97%|█████████▋| 97/100 [2:40:08<03:49, 76.45s/it] 98%|█████████▊| 98/100 [2:40:08<02:09, 64.67s/it]                                                   98%|█████████▊| 98/100 [2:40:45<02:09, 64.67s/it] 99%|█████████▉| 99/100 [2:40:45<00:56, 56.49s/it]                                                   99%|█████████▉| 99/100 [2:41:23<00:56, 56.49s/it]100%|██████████| 100/100 [2:41:23<00:00, 50.75s/it]100%|██████████| 100/100 [2:41:23<00:00, 96.83s/it]
[Epoch 1/100] Train Loss: 0.0245, Val Loss: 0.0115
[Epoch 2/100] Train Loss: 0.0119, Val Loss: 0.0089
[Epoch 3/100] Train Loss: 0.0099, Val Loss: 0.0073
[Epoch 4/100] Train Loss: 0.0086, Val Loss: 0.0069
[Epoch 5/100] Train Loss: 0.0077, Val Loss: 0.0062
[Epoch 6/100] Train Loss: 0.0069, Val Loss: 0.0054
[Epoch 7/100] Train Loss: 0.0063, Val Loss: 0.0048
[Epoch 8/100] Train Loss: 0.0058, Val Loss: 0.0044
[Epoch 9/100] Train Loss: 0.0055, Val Loss: 0.0043
[Epoch 10/100] Train Loss: 0.0051, Val Loss: 0.0040
[Epoch 11/100] Train Loss: 0.0049, Val Loss: 0.0038
[Epoch 12/100] Train Loss: 0.0046, Val Loss: 0.0037
[Epoch 13/100] Train Loss: 0.0044, Val Loss: 0.0036
[Epoch 14/100] Train Loss: 0.0042, Val Loss: 0.0031
[Epoch 15/100] Train Loss: 0.0040, Val Loss: 0.0034
[Epoch 16/100] Train Loss: 0.0038, Val Loss: 0.0030
[Epoch 17/100] Train Loss: 0.0037, Val Loss: 0.0028
[Epoch 18/100] Train Loss: 0.0035, Val Loss: 0.0027
[Epoch 19/100] Train Loss: 0.0034, Val Loss: 0.0026
[Epoch 20/100] Train Loss: 0.0033, Val Loss: 0.0027
[Epoch 21/100] Train Loss: 0.0032, Val Loss: 0.0026
[Epoch 22/100] Train Loss: 0.0031, Val Loss: 0.0028
[Epoch 23/100] Train Loss: 0.0030, Val Loss: 0.0023
[Epoch 24/100] Train Loss: 0.0030, Val Loss: 0.0024
[Epoch 25/100] Train Loss: 0.0029, Val Loss: 0.0021
[Epoch 26/100] Train Loss: 0.0028, Val Loss: 0.0025
[Epoch 27/100] Train Loss: 0.0028, Val Loss: 0.0021
[Epoch 28/100] Train Loss: 0.0027, Val Loss: 0.0020
[Epoch 29/100] Train Loss: 0.0027, Val Loss: 0.0021
[Epoch 30/100] Train Loss: 0.0026, Val Loss: 0.0022
[Epoch 31/100] Train Loss: 0.0026, Val Loss: 0.0021
[Epoch 32/100] Train Loss: 0.0026, Val Loss: 0.0019
[Epoch 33/100] Train Loss: 0.0025, Val Loss: 0.0021
[Epoch 34/100] Train Loss: 0.0025, Val Loss: 0.0021
[Epoch 35/100] Train Loss: 0.0025, Val Loss: 0.0018
[Epoch 36/100] Train Loss: 0.0024, Val Loss: 0.0019
[Epoch 37/100] Train Loss: 0.0024, Val Loss: 0.0019
[Epoch 38/100] Train Loss: 0.0024, Val Loss: 0.0019
[Epoch 39/100] Train Loss: 0.0024, Val Loss: 0.0020
[Epoch 40/100] Train Loss: 0.0023, Val Loss: 0.0019
[Epoch 41/100] Train Loss: 0.0023, Val Loss: 0.0019
[Epoch 42/100] Train Loss: 0.0023, Val Loss: 0.0018
[Epoch 43/100] Train Loss: 0.0022, Val Loss: 0.0020
[Epoch 44/100] Train Loss: 0.0022, Val Loss: 0.0019
[Epoch 45/100] Train Loss: 0.0022, Val Loss: 0.0018
[Epoch 46/100] Train Loss: 0.0022, Val Loss: 0.0019
[Epoch 47/100] Train Loss: 0.0022, Val Loss: 0.0017
[Epoch 48/100] Train Loss: 0.0021, Val Loss: 0.0020
[Epoch 49/100] Train Loss: 0.0021, Val Loss: 0.0018
[Epoch 50/100] Train Loss: 0.0021, Val Loss: 0.0016
[Epoch 51/100] Train Loss: 0.0021, Val Loss: 0.0017
[Epoch 52/100] Train Loss: 0.0021, Val Loss: 0.0017
[Epoch 53/100] Train Loss: 0.0021, Val Loss: 0.0017
[Epoch 54/100] Train Loss: 0.0021, Val Loss: 0.0018
[Epoch 55/100] Train Loss: 0.0020, Val Loss: 0.0017
[Epoch 56/100] Train Loss: 0.0020, Val Loss: 0.0016
[Epoch 57/100] Train Loss: 0.0020, Val Loss: 0.0020
[Epoch 58/100] Train Loss: 0.0020, Val Loss: 0.0017
[Epoch 59/100] Train Loss: 0.0020, Val Loss: 0.0018
[Epoch 60/100] Train Loss: 0.0020, Val Loss: 0.0016
[Epoch 61/100] Train Loss: 0.0020, Val Loss: 0.0017
[Epoch 62/100] Train Loss: 0.0019, Val Loss: 0.0017
[Epoch 63/100] Train Loss: 0.0019, Val Loss: 0.0016
[Epoch 64/100] Train Loss: 0.0019, Val Loss: 0.0017
[Epoch 65/100] Train Loss: 0.0019, Val Loss: 0.0016
[Epoch 66/100] Train Loss: 0.0019, Val Loss: 0.0017
[Epoch 67/100] Train Loss: 0.0019, Val Loss: 0.0017
[Epoch 68/100] Train Loss: 0.0019, Val Loss: 0.0017
[Epoch 69/100] Train Loss: 0.0019, Val Loss: 0.0017
[Epoch 70/100] Train Loss: 0.0019, Val Loss: 0.0017
[Epoch 71/100] Train Loss: 0.0019, Val Loss: 0.0015
[Epoch 72/100] Train Loss: 0.0018, Val Loss: 0.0016
[Epoch 73/100] Train Loss: 0.0019, Val Loss: 0.0015
[Epoch 74/100] Train Loss: 0.0018, Val Loss: 0.0015
[Epoch 75/100] Train Loss: 0.0018, Val Loss: 0.0016
[Epoch 76/100] Train Loss: 0.0018, Val Loss: 0.0015
[Epoch 77/100] Train Loss: 0.0018, Val Loss: 0.0018
[Epoch 78/100] Train Loss: 0.0018, Val Loss: 0.0015
[Epoch 79/100] Train Loss: 0.0018, Val Loss: 0.0015
[Epoch 80/100] Train Loss: 0.0018, Val Loss: 0.0016
[Epoch 81/100] Train Loss: 0.0018, Val Loss: 0.0016
[Epoch 82/100] Train Loss: 0.0018, Val Loss: 0.0015
[Epoch 83/100] Train Loss: 0.0018, Val Loss: 0.0015
[Epoch 84/100] Train Loss: 0.0018, Val Loss: 0.0014
[Epoch 85/100] Train Loss: 0.0017, Val Loss: 0.0015
[Epoch 86/100] Train Loss: 0.0017, Val Loss: 0.0015
[Epoch 87/100] Train Loss: 0.0017, Val Loss: 0.0016
[Epoch 88/100] Train Loss: 0.0017, Val Loss: 0.0015
[Epoch 89/100] Train Loss: 0.0017, Val Loss: 0.0017
[Epoch 90/100] Train Loss: 0.0017, Val Loss: 0.0014
[Epoch 91/100] Train Loss: 0.0017, Val Loss: 0.0015
[Epoch 92/100] Train Loss: 0.0017, Val Loss: 0.0015
[Epoch 93/100] Train Loss: 0.0017, Val Loss: 0.0015
[Epoch 94/100] Train Loss: 0.0017, Val Loss: 0.0015
[Epoch 95/100] Train Loss: 0.0017, Val Loss: 0.0016
[Epoch 96/100] Train Loss: 0.0017, Val Loss: 0.0015
[Epoch 97/100] Train Loss: 0.0017, Val Loss: 0.0014
[Epoch 98/100] Train Loss: 0.0017, Val Loss: 0.0015
[Epoch 99/100] Train Loss: 0.0017, Val Loss: 0.0016
[Epoch 100/100] Train Loss: 0.0017, Val Loss: 0.0015
[TEST] testing global joint masking========================================
Aha! pretraining is done!
====================================================================================================
====================================================================================================
====================================================================================================
====================================================================================================
pretrained model loaded successfully!
[INFO] finetuning the entire T1 model...
is T1 freezed? False
unfreezing layers: None
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:53<1:27:33, 53.06s/it]  2%|▏         | 2/100 [01:45<1:26:18, 52.84s/it]  3%|▎         | 3/100 [02:38<1:25:21, 52.80s/it]  4%|▍         | 4/100 [03:31<1:24:19, 52.71s/it]  5%|▌         | 5/100 [04:24<1:23:41, 52.86s/it]  6%|▌         | 6/100 [05:16<1:22:39, 52.76s/it]  7%|▋         | 7/100 [06:09<1:21:41, 52.70s/it]  8%|▊         | 8/100 [07:01<1:20:42, 52.63s/it]  9%|▉         | 9/100 [07:54<1:19:47, 52.61s/it] 10%|█         | 10/100 [08:46<1:18:51, 52.57s/it] 11%|█         | 11/100 [09:39<1:17:57, 52.56s/it] 12%|█▏        | 12/100 [10:31<1:17:02, 52.53s/it] 13%|█▎        | 13/100 [11:24<1:16:07, 52.50s/it] 14%|█▍        | 14/100 [12:16<1:15:12, 52.47s/it] 15%|█▌        | 15/100 [13:09<1:14:17, 52.44s/it] 16%|█▌        | 16/100 [14:01<1:13:24, 52.44s/it] 17%|█▋        | 17/100 [14:53<1:12:31, 52.43s/it] 18%|█▊        | 18/100 [15:46<1:11:43, 52.48s/it] 19%|█▉        | 19/100 [16:39<1:10:53, 52.51s/it] 20%|██        | 20/100 [17:31<1:10:02, 52.53s/it] 21%|██        | 21/100 [18:24<1:09:07, 52.50s/it] 22%|██▏       | 22/100 [19:16<1:08:14, 52.49s/it] 23%|██▎       | 23/100 [20:08<1:07:19, 52.47s/it] 24%|██▍       | 24/100 [21:01<1:06:27, 52.47s/it] 25%|██▌       | 25/100 [21:53<1:05:33, 52.45s/it] 26%|██▌       | 26/100 [22:46<1:04:41, 52.45s/it] 27%|██▋       | 27/100 [23:39<1:04:13, 52.78s/it] 28%|██▊       | 28/100 [24:32<1:03:15, 52.71s/it] 29%|██▉       | 29/100 [25:24<1:02:17, 52.63s/it] 30%|███       | 30/100 [26:17<1:01:21, 52.60s/it] 31%|███       | 31/100 [27:09<1:00:26, 52.55s/it] 32%|███▏      | 32/100 [28:02<59:33, 52.55s/it]   33%|███▎      | 33/100 [28:54<58:37, 52.50s/it] 34%|███▍      | 34/100 [29:47<57:44, 52.49s/it] 35%|███▌      | 35/100 [30:39<56:50, 52.46s/it] 36%|███▌      | 36/100 [31:32<55:58, 52.48s/it] 37%|███▋      | 37/100 [32:25<55:20, 52.70s/it] 38%|███▊      | 38/100 [33:17<54:24, 52.66s/it] 39%|███▉      | 39/100 [34:10<53:26, 52.57s/it] 40%|████      | 40/100 [35:02<52:32, 52.54s/it] 41%|████      | 41/100 [35:55<51:37, 52.51s/it] 42%|████▏     | 42/100 [36:47<50:46, 52.52s/it] 43%|████▎     | 43/100 [37:40<49:53, 52.51s/it] 44%|████▍     | 44/100 [38:32<49:01, 52.52s/it] 45%|████▌     | 45/100 [39:28<49:02, 53.49s/it] 46%|████▌     | 46/100 [40:21<47:59, 53.32s/it] 47%|████▋     | 47/100 [41:13<46:51, 53.04s/it] 48%|████▊     | 48/100 [42:06<45:49, 52.87s/it] 49%|████▉     | 49/100 [42:58<44:49, 52.74s/it] 50%|█████     | 50/100 [43:52<44:06, 52.93s/it] 51%|█████     | 51/100 [44:44<43:05, 52.77s/it] 52%|█████▏    | 52/100 [45:37<42:09, 52.70s/it] 53%|█████▎    | 53/100 [46:29<41:15, 52.68s/it] 54%|█████▍    | 54/100 [47:22<40:22, 52.67s/it] 55%|█████▌    | 55/100 [48:14<39:27, 52.62s/it] 56%|█████▌    | 56/100 [49:07<38:35, 52.62s/it] 57%|█████▋    | 57/100 [50:00<37:43, 52.63s/it] 58%|█████▊    | 58/100 [50:52<36:50, 52.63s/it] 59%|█████▉    | 59/100 [51:45<35:56, 52.59s/it] 60%|██████    | 60/100 [52:37<35:03, 52.59s/it] 61%|██████    | 61/100 [53:30<34:10, 52.58s/it] 62%|██████▏   | 62/100 [54:23<33:18, 52.60s/it] 63%|██████▎   | 63/100 [55:15<32:26, 52.61s/it] 64%|██████▍   | 64/100 [56:08<31:33, 52.61s/it] 65%|██████▌   | 65/100 [57:00<30:40, 52.58s/it] 66%|██████▌   | 66/100 [57:53<29:48, 52.59s/it] 67%|██████▋   | 67/100 [58:46<28:56, 52.62s/it] 68%|██████▊   | 68/100 [59:38<28:04, 52.63s/it] 69%|██████▉   | 69/100 [1:00:31<27:12, 52.66s/it] 70%|███████   | 70/100 [1:01:24<26:21, 52.70s/it] 71%|███████   | 71/100 [1:02:16<25:28, 52.71s/it] 72%|███████▏  | 72/100 [1:03:09<24:34, 52.66s/it] 73%|███████▎  | 73/100 [1:04:02<23:41, 52.64s/it] 74%|███████▍  | 74/100 [1:04:54<22:48, 52.62s/it] 75%|███████▌  | 75/100 [1:05:47<21:55, 52.63s/it] 76%|███████▌  | 76/100 [1:06:39<21:02, 52.60s/it] 77%|███████▋  | 77/100 [1:07:32<20:09, 52.61s/it] 78%|███████▊  | 78/100 [1:08:25<19:16, 52.58s/it] 79%|███████▉  | 79/100 [1:09:17<18:24, 52.57s/it] 80%|████████  | 80/100 [1:10:10<17:30, 52.54s/it] 81%|████████  | 81/100 [1:11:02<16:38, 52.57s/it] 82%|████████▏ | 82/100 [1:11:55<15:46, 52.57s/it] 83%|████████▎ | 83/100 [1:12:47<14:54, 52.59s/it] 84%|████████▍ | 84/100 [1:13:40<14:01, 52.60s/it] 85%|████████▌ | 85/100 [1:14:34<13:14, 52.97s/it] 86%|████████▌ | 86/100 [1:15:27<12:22, 53.04s/it] 87%|████████▋ | 87/100 [1:16:20<11:28, 52.98s/it] 88%|████████▊ | 88/100 [1:17:12<10:34, 52.86s/it] 89%|████████▉ | 89/100 [1:18:05<09:40, 52.79s/it] 90%|█████████ | 90/100 [1:18:58<08:47, 52.71s/it] 91%|█████████ | 91/100 [1:19:50<07:54, 52.68s/it] 92%|█████████▏| 92/100 [1:20:43<07:01, 52.64s/it] 93%|█████████▎| 93/100 [1:21:35<06:08, 52.66s/it] 94%|█████████▍| 94/100 [1:22:28<05:15, 52.59s/it] 95%|█████████▌| 95/100 [1:23:20<04:22, 52.58s/it] 96%|█████████▌| 96/100 [1:24:13<03:30, 52.63s/it] 97%|█████████▋| 97/100 [1:25:06<02:38, 52.74s/it] 98%|█████████▊| 98/100 [1:25:59<01:45, 52.68s/it] 99%|█████████▉| 99/100 [1:26:51<00:52, 52.64s/it]100%|██████████| 100/100 [1:27:44<00:00, 52.58s/it]100%|██████████| 100/100 [1:27:44<00:00, 52.64s/it]
Epoch 1/100: Train Acc = 0.0913, Val Acc = 0.0409
✅ Best model updated at epoch 1 with val acc: 0.0409
Epoch 2/100: Train Acc = 0.6153, Val Acc = 0.6466
✅ Best model updated at epoch 2 with val acc: 0.6466
Epoch 3/100: Train Acc = 0.8180, Val Acc = 0.8060
✅ Best model updated at epoch 3 with val acc: 0.8060
Epoch 4/100: Train Acc = 0.9001, Val Acc = 0.8362
✅ Best model updated at epoch 4 with val acc: 0.8362
Epoch 5/100: Train Acc = 0.9302, Val Acc = 0.8060
Epoch 6/100: Train Acc = 0.9451, Val Acc = 0.8341
Epoch 7/100: Train Acc = 0.9609, Val Acc = 0.8362
Epoch 8/100: Train Acc = 0.9708, Val Acc = 0.8168
Epoch 9/100: Train Acc = 0.9750, Val Acc = 0.8211
Epoch 10/100: Train Acc = 0.9818, Val Acc = 0.8362
Epoch 11/100: Train Acc = 0.9834, Val Acc = 0.7953
Epoch 12/100: Train Acc = 0.9845, Val Acc = 0.8254
Epoch 13/100: Train Acc = 0.9857, Val Acc = 0.8621
✅ Best model updated at epoch 13 with val acc: 0.8621
Epoch 14/100: Train Acc = 0.9897, Val Acc = 0.8017
Epoch 15/100: Train Acc = 0.9888, Val Acc = 0.8060
Epoch 16/100: Train Acc = 0.9902, Val Acc = 0.7996
Epoch 17/100: Train Acc = 0.9908, Val Acc = 0.8534
Epoch 18/100: Train Acc = 0.9913, Val Acc = 0.8125
Epoch 19/100: Train Acc = 0.9937, Val Acc = 0.8125
Epoch 20/100: Train Acc = 0.9920, Val Acc = 0.8125
Epoch 21/100: Train Acc = 0.9950, Val Acc = 0.7931
Epoch 22/100: Train Acc = 0.9924, Val Acc = 0.8039
Epoch 23/100: Train Acc = 0.9947, Val Acc = 0.7823
Epoch 24/100: Train Acc = 0.9942, Val Acc = 0.7974
Epoch 25/100: Train Acc = 0.9959, Val Acc = 0.8233
Epoch 26/100: Train Acc = 0.9948, Val Acc = 0.8103
Epoch 27/100: Train Acc = 0.9953, Val Acc = 0.8276
Epoch 28/100: Train Acc = 0.9959, Val Acc = 0.8448
Epoch 29/100: Train Acc = 0.9961, Val Acc = 0.8341
Epoch 30/100: Train Acc = 0.9960, Val Acc = 0.8664
✅ Best model updated at epoch 30 with val acc: 0.8664
Epoch 31/100: Train Acc = 0.9963, Val Acc = 0.8405
Epoch 32/100: Train Acc = 0.9976, Val Acc = 0.8448
Epoch 33/100: Train Acc = 0.9968, Val Acc = 0.8103
Epoch 34/100: Train Acc = 0.9975, Val Acc = 0.8599
Epoch 35/100: Train Acc = 0.9974, Val Acc = 0.8060
Epoch 36/100: Train Acc = 0.9963, Val Acc = 0.8470
Epoch 37/100: Train Acc = 0.9983, Val Acc = 0.8470
Epoch 38/100: Train Acc = 0.9972, Val Acc = 0.8276
Epoch 39/100: Train Acc = 0.9985, Val Acc = 0.8103
Epoch 40/100: Train Acc = 0.9983, Val Acc = 0.8254
Epoch 41/100: Train Acc = 0.9981, Val Acc = 0.8341
Epoch 42/100: Train Acc = 0.9982, Val Acc = 0.7953
Epoch 43/100: Train Acc = 0.9982, Val Acc = 0.8168
Epoch 44/100: Train Acc = 0.9981, Val Acc = 0.8168
Epoch 45/100: Train Acc = 0.9987, Val Acc = 0.8254
Epoch 46/100: Train Acc = 0.9990, Val Acc = 0.8836
✅ Best model updated at epoch 46 with val acc: 0.8836
Epoch 47/100: Train Acc = 0.9986, Val Acc = 0.8362
Epoch 48/100: Train Acc = 0.9990, Val Acc = 0.8427
Epoch 49/100: Train Acc = 0.9988, Val Acc = 0.8728
Epoch 50/100: Train Acc = 0.9994, Val Acc = 0.8578
Epoch 51/100: Train Acc = 0.9990, Val Acc = 0.8621
Epoch 52/100: Train Acc = 0.9999, Val Acc = 0.8685
Epoch 53/100: Train Acc = 0.9987, Val Acc = 0.8297
Epoch 54/100: Train Acc = 0.9990, Val Acc = 0.8750
Epoch 55/100: Train Acc = 0.9998, Val Acc = 0.8685
Epoch 56/100: Train Acc = 0.9995, Val Acc = 0.8750
Epoch 57/100: Train Acc = 0.9997, Val Acc = 0.8664
Epoch 58/100: Train Acc = 0.9992, Val Acc = 0.8211
Epoch 59/100: Train Acc = 0.9999, Val Acc = 0.8750
Epoch 60/100: Train Acc = 0.9999, Val Acc = 0.8664
Epoch 61/100: Train Acc = 0.9994, Val Acc = 0.8534
Epoch 62/100: Train Acc = 1.0000, Val Acc = 0.8578
Epoch 63/100: Train Acc = 0.9998, Val Acc = 0.8405
Epoch 64/100: Train Acc = 1.0000, Val Acc = 0.8384
Epoch 65/100: Train Acc = 1.0000, Val Acc = 0.8405
Epoch 66/100: Train Acc = 0.9999, Val Acc = 0.8599
Epoch 67/100: Train Acc = 1.0000, Val Acc = 0.8578
Epoch 68/100: Train Acc = 1.0000, Val Acc = 0.8534
Epoch 69/100: Train Acc = 1.0000, Val Acc = 0.8427
Epoch 70/100: Train Acc = 1.0000, Val Acc = 0.8427
Epoch 71/100: Train Acc = 1.0000, Val Acc = 0.8448
Epoch 72/100: Train Acc = 1.0000, Val Acc = 0.8319
Epoch 73/100: Train Acc = 0.9999, Val Acc = 0.8491
Epoch 74/100: Train Acc = 1.0000, Val Acc = 0.8491
Epoch 75/100: Train Acc = 1.0000, Val Acc = 0.8599
Epoch 76/100: Train Acc = 0.9999, Val Acc = 0.8405
Epoch 77/100: Train Acc = 1.0000, Val Acc = 0.8448
Epoch 78/100: Train Acc = 1.0000, Val Acc = 0.8448
Epoch 79/100: Train Acc = 1.0000, Val Acc = 0.8578
Epoch 80/100: Train Acc = 0.9999, Val Acc = 0.8750
Epoch 81/100: Train Acc = 1.0000, Val Acc = 0.8728
Epoch 82/100: Train Acc = 1.0000, Val Acc = 0.8621
Epoch 83/100: Train Acc = 1.0000, Val Acc = 0.8728
Epoch 84/100: Train Acc = 1.0000, Val Acc = 0.8728
Epoch 85/100: Train Acc = 1.0000, Val Acc = 0.8728
Epoch 86/100: Train Acc = 1.0000, Val Acc = 0.8707
Epoch 87/100: Train Acc = 1.0000, Val Acc = 0.8707
Epoch 88/100: Train Acc = 1.0000, Val Acc = 0.8621
Epoch 89/100: Train Acc = 1.0000, Val Acc = 0.8599
Epoch 90/100: Train Acc = 1.0000, Val Acc = 0.8599
Epoch 91/100: Train Acc = 1.0000, Val Acc = 0.8621
Epoch 92/100: Train Acc = 1.0000, Val Acc = 0.8621
Epoch 93/100: Train Acc = 1.0000, Val Acc = 0.8621
Epoch 94/100: Train Acc = 1.0000, Val Acc = 0.8621
Epoch 95/100: Train Acc = 1.0000, Val Acc = 0.8621
Epoch 96/100: Train Acc = 1.0000, Val Acc = 0.8621
Epoch 97/100: Train Acc = 1.0000, Val Acc = 0.8621
Epoch 98/100: Train Acc = 1.0000, Val Acc = 0.8621
Epoch 99/100: Train Acc = 1.0000, Val Acc = 0.8621
Epoch 100/100: Train Acc = 1.0000, Val Acc = 0.8621
Aha! Finetuning completed successfully!
💎💎💎💎💎💎💎💎💎💎💎💎💎💎💎💎💎💎💎💎
[INFO] Final accuracy after finetuning: 0.8836
Aha! finetuned models saved successfully!
************Unfreezing layers: entire
[INFO] Evaluation completed!
Final Accuracy: 0.8836
